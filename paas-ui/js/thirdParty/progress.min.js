(function($){$.fn.Progress=function(el){var config=$.extend({val:0,size:20,drag:true,tip:true,title:false,toFixed:0,direction:"horizontal"},el);return this.each(function(){var that=$(this);var idx=that.index();var numW=config.val;var numOld;var x;var dir=config.direction;var lineH=config.size;var $ProgressBar=$('<div class="ProgressBar"></div>');$ProgressBar.height(lineH).css("borderRadius",lineH/2);var $ProgressLine=$('<div class="ProgressLine" id="Progress'+idx+'" text-content-after=""></div>');$ProgressLine.css("borderRadius",lineH/2);var $input=$('<text class="progressVal"></text>');$ProgressBar.append($ProgressLine);$ProgressBar.children().append($input);that.append($ProgressBar);var lineW=(config.val/100)*($ProgressBar.width()-lineH);$ProgressLine.css("width",lineW+lineH);if(numW<=0){numW=0}if(numW>=100){numW=100}config.tip&&$ProgressLine.attr("text-content-after",numW);$input.text(numW);numOld=numW;$("head").append("<style>#Progress"+idx+"::before{ width:"+lineH+"px }</style>");switch(dir){case"vertical":that.children().addClass("vertical");break}var left=(config.size-$input.width())/2;$(this).find(".progressVal").css("right",left);if(!config.drag){$ProgressLine.addClass("disabled");return}if(config.setVal){config.setVal(function setValue(i){var i=i.toFixed(config.toFixed);var lineW=(i/100)*($ProgressBar.width()-lineH);var wid=lineW+lineH;if(lineW+lineH>$(this).width()){wid=$(this).width()}if(i<=0){i=0}if(i>=100){i=100}$ProgressLine.css("width",wid);$(this).find(".progressVal").text(i);config.tip&&$ProgressLine.attr("text-content-after",i)}.bind(this))}$(this)[0].toFixed=config.toFixed;$(this)[0].lineH=lineH;$(this)[0].tip=config.tip;jQuery.fn.extend({updateValue:function(i){if(i<0||i>100){return}var i=i.toFixed(this[0].toFixed);var lineH=this[0].lineH;var lineW=(i/100)*($(this).find(".ProgressBar").width()-lineH);var wid=lineW+lineH;if(lineW+lineH>$(this).width()){wid=$(this).width()}if(i<=0){i=0}if(i>=100){i=100}$(this).find(".ProgressLine").css("width",wid);$(this).find(".progressVal").text(i);this[0].tip&&$(this).find(".ProgressLine").attr("text-content-after",i)}});if(config.title){$(this).hover(function(){$(this).find(".progressVal").stop(true).fadeIn()},function(){$(this).find(".progressVal").stop(true).fadeOut()})}function setProW(e){switch(dir){case"horizontal":x=e.pageX-$ProgressBar.offset().left+lineH/2;break;case"vertical":x=$ProgressBar.width()-(e.pageY-$ProgressBar.offset().top-lineH/2);break}x=Math.max(lineH,x);x=Math.min($ProgressBar.width(),x);$ProgressLine.css("width",x);numW=(((x-lineH)/($ProgressBar.width()-lineH))*100).toFixed(config.toFixed);if(numW<=0){numW=0}if(numW>=100){numW=100}config.tip&&$ProgressLine.attr("text-content-after",numW);if(numOld!=numW){$input.text(numW);config.getVal(numW)}}function titleShow(title,i,that){if(title){that.find(".titleTip").text(i)}}that.on("mousedown",function(e){e.preventDefault();e.stopPropagation();var x;$(document).on("mousemove",function(e){numOld=numW;e.stopPropagation();e.preventDefault();setProW(e)});setProW(e)});$(document).on("mouseup",function(e){e.preventDefault();e.stopPropagation();$(document).off("mousemove")})})}})(jQuery);